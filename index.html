<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>USD/EUR & DXY تحلیل لحظه‌ای</title>
</head>
<body style="font-family: Arial, sans-serif; direction: rtl; text-align: center; background: #f9f9f9;">
  <h1>📊 داشبورد لحظه‌ای دلار / یورو</h1>
  <button onclick="getBias()" style="padding:10px 20px; margin:10px; font-size:16px;">بروزرسانی</button>
  <pre id="output" style="text-align:left; background:#fff; padding:10px; max-width:600px; margin:auto; border:1px solid #ddd;"></pre>

  <script>
    async function getBias() {
      document.getElementById('output').innerText = "در حال دریافت اطلاعات...";

      try {
        // گرفتن نرخ ها از Frankfurter API
        const res = await fetch("https://api.frankfurter.app/latest?from=USD&to=EUR,JPY,GBP,CAD,SEK,CHF");
        const data = await res.json();
        const rates = data.rates;

        // نرخ ها
        const eurusd = 1 / rates.EUR; 
        const jpyusd = 1 / rates.JPY;
        const gbpusd = 1 / rates.GBP;
        const cadusd = 1 / rates.CAD;
        const sekusd = 1 / rates.SEK;
        const chfusd = 1 / rates.CHF;

        // محاسبه DXY تقریبی (وزن‌های رسمی)
        // وزن‌ها: EUR 57.6%, JPY 13.6%, GBP 11.9%, CAD 9.1%, SEK 4.2%, CHF 3.6%
        const dxy = 50.14348112 *
          Math.pow(rates.EUR, -0.576) *
          Math.pow(rates.JPY, 0.136) *
          Math.pow(rates.GBP, -0.119) *
          Math.pow(rates.CAD, -0.091) *
          Math.pow(rates.SEK, -0.042) *
          Math.pow(rates.CHF, -0.036);

        // نتیجه گیری ساده
        let bias = "خنثی";
        let reason = "";
        if (eurusd > 1.09) {
          bias = "ضعف دلار";
          reason = "یورو بالای 1.09 معامله می‌شود → فشار فروش روی دلار";
        } else if (eurusd < 1.07) {
          bias = "قدرت دلار";
          reason = "یورو زیر 1.07 معامله می‌شود → تقاضای قوی برای دلار";
        } else {
          reason = "یورو در محدوده‌ی خنثی قرار دارد";
        }

        const output = {
          "EUR/USD": eurusd.toFixed(4),
          "USD/JPY": jpyusd.toFixed(2),
          "GBP/USD": gbpusd.toFixed(4),
          "USD/CAD": cadusd.toFixed(4),
          "USD/SEK": sekusd.toFixed(4),
          "USD/CHF": chfusd.toFixed(4),
          "DXY (approx)": dxy.toFixed(2),
          "نتیجه‌گیری": bias,
          "دلیل فاندامنتال": reason,
          "زمان": new Date().toLocaleString("fa-IR")
        };

        document.getElementById('output').innerText = JSON.stringify(output, null, 2);
      } catch (err) {
        document.getElementById('output').innerText = "❌ خطا در دریافت داده‌ها: " + err;
      }
    }
  </script>
</body>
</html>
